{"ast":null,"code":"import React,{useState,useEffect}from'react';import{db}from'../../firebase/config';import{collection,addDoc,getDocs,query,where,deleteDoc,doc}from'firebase/firestore';import{getDeviceId}from'../../utils/deviceId';import Dashboard from'../Dashboard/Dashboard';import'./Analytics.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Analytics=()=>{const[name,setName]=useState('');const[savedName,setSavedName]=useState('');const[docId,setDocId]=useState(null);const deviceId=getDeviceId();const[showWelcome,setShowWelcome]=useState(true);const authorizedUsers=[{names:['شمس','شموس','shams','shmoos'],type:'shams'},{names:['بنين','بنونه','baneen'],type:'baneen'},{names:['علي','على','ali'],type:'ali'},{names:['مجتبى','مجتبا','mojtaba'],type:'mojtaba'}];const isAuthorized=name=>{const lowerName=name.toLowerCase().trim();return authorizedUsers.some(user=>user.names.includes(lowerName));};const getUserType=name=>{var _authorizedUsers$find;const lowerName=name.toLowerCase().trim();return((_authorizedUsers$find=authorizedUsers.find(user=>user.names.includes(lowerName)))===null||_authorizedUsers$find===void 0?void 0:_authorizedUsers$find.type)||'unauthorized';};useEffect(()=>{const fetchName=async()=>{const q=query(collection(db,'users'),where('deviceId','==',deviceId));const querySnapshot=await getDocs(q);querySnapshot.forEach(doc=>{setSavedName(doc.data().name);setDocId(doc.id);});};fetchName();},[deviceId]);useEffect(()=>{if(savedName){const timer=setTimeout(()=>{setShowWelcome(false);},2000);return()=>clearTimeout(timer);}},[savedName]);const getWelcomeMessage=name=>{if(!isAuthorized(name)){return/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special unauthorized-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u26D4 \\u0639\\u0630\\u0631\\u0627\\u064B! \\u0623\\u0646\\u062A \\u063A\\u064A\\u0631 \\u0645\\u0635\\u0631\\u062D \\u0644\\u0643 \\u0628\\u0627\\u0644\\u062F\\u062E\\u0648\\u0644 \\u26D4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDEAB\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u26D4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDEA7\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"unauthorized-message\",children:\"\\u0647\\u0630\\u0627 \\u0627\\u0644\\u062A\\u0637\\u0628\\u064A\\u0642 \\u0645\\u062E\\u0635\\u0635 \\u0641\\u0642\\u0637 \\u0644\\u0644\\u0645\\u0633\\u062A\\u062E\\u062F\\u0645\\u064A\\u0646 \\u0627\\u0644\\u0645\\u0635\\u0631\\u062D \\u0644\\u0647\\u0645\"})]});}const userType=getUserType(name);switch(userType){case'shams':return/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special shams-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u2728 \\u0634\\u0645\\u0648\\u0633\\u0633\\u0633 \\u0627\\u0644\\u063A\\u0627\\u0644\\u064A \\u0627\\u0647\\u0644\\u0627 \\u2728\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF1F\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u2B50\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCAB\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF1E\"})]})]});case'baneen':return/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special baneen-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDC9D \\u0647\\u0644\\u0627\\u0648\\u0648\\u0648\\u0648 \\u0628\\u0646\\u0648\\u0646\\u0647 \\uD83D\\uDC9D\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF80\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC96\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83E\\uDD8B\"})]})]});case'ali':return/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special ali-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83C\\uDF1F \\u0645\\u0631\\u062D\\u0628\\u0627\\u064B \\u0639\\u0644\\u0627\\u0648\\u064A\\u064A\\u064A\\u064A \\uD83C\\uDF1F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCAA\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC51\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF89\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A1\"})]})]});case'mojtaba':return/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special mojtaba-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83C\\uDF19 \\u0623\\u0647\\u0644\\u0627\\u064B \\u0645\\u062C\\u062A\\u0628\\u0649 \\uD83C\\uDF19\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF19\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF1F\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCAB\"})]})]});default:return null;}};const handleSubmit=async e=>{e.preventDefault();if(!isAuthorized(name)){setSavedName(name);// Still set the name to show unauthorized message\nreturn;}try{const docRef=await addDoc(collection(db,'users'),{name:name,deviceId:deviceId,timestamp:new Date()});setSavedName(name);setDocId(docRef.id);setName('');}catch(error){console.error(\"Error adding name: \",error);}};const handleRemove=async()=>{try{if(docId){await deleteDoc(doc(db,'users',docId));setSavedName('');setDocId(null);}}catch(error){console.error(\"Error removing name: \",error);}};const UserUnauthorizedScreen=()=>/*#__PURE__*/_jsx(\"div\",{className:\"unauthorized-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special unauthorized-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u26D4 \\u0639\\u0630\\u0631\\u0627\\u064B! \\u0623\\u0646\\u062A \\u063A\\u064A\\u0631 \\u0645\\u0635\\u0631\\u062D \\u0644\\u0643 \\u0628\\u0627\\u0644\\u062F\\u062E\\u0648\\u0644 \\u26D4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDEAB\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u26D4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDEA7\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"unauthorized-message\",children:\"\\u0647\\u0630\\u0627 \\u0627\\u0644\\u062A\\u0637\\u0628\\u064A\\u0642 \\u0645\\u062E\\u0635\\u0635 \\u0641\\u0642\\u0637 \\u0644\\u0644\\u0645\\u0633\\u062A\\u062E\\u062F\\u0645\\u064A\\u0646 \\u0627\\u0644\\u0645\\u0635\\u0631\\u062D \\u0644\\u0647\\u0645\"}),/*#__PURE__*/_jsx(\"button\",{className:\"reset-btn\",onClick:handleRemove,children:\"\\u0627\\u0644\\u0639\\u0648\\u062F\\u0629 \\u0644\\u0644\\u0635\\u0641\\u062D\\u0629 \\u0627\\u0644\\u0631\\u0626\\u064A\\u0633\\u064A\\u0629\"})]})});const renderAnalyticsStats=()=>{var _orders,_orders2,_orders3;// حساب الإحصائيات\nconst totalOrders=((_orders=orders)===null||_orders===void 0?void 0:_orders.length)||0;const totalRevenue=((_orders2=orders)===null||_orders2===void 0?void 0:_orders2.reduce((sum,order)=>sum+Number(order.sellingPrice),0))||0;const totalCosts=((_orders3=orders)===null||_orders3===void 0?void 0:_orders3.reduce((sum,order)=>sum+Number(order.costPrice),0))||0;const profitMargin=totalRevenue>0?((totalRevenue-totalCosts)/totalRevenue*100).toFixed(1):0;const averageOrderValue=totalOrders>0?(totalRevenue/totalOrders).toFixed(0):0;return/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(240px, 1fr))',gap:'20px',marginBottom:'30px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #4CAF50 0%, #45a049 100%)',borderRadius:'15px',padding:'20px',color:'white',transition:'transform 0.3s ease',cursor:'pointer',':hover':{transform:'translateY(-5px)'}},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0',fontSize:'0.9rem',opacity:0.9},children:\"\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A \\u0627\\u0644\\u0625\\u064A\\u0631\\u0627\\u062F\\u0627\\u062A\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'1.5rem',fontWeight:'bold',marginTop:'10px'},children:[totalRevenue.toLocaleString(),\" \\u062F.\\u0639\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #f44336 0%, #e53935 100%)',borderRadius:'15px',padding:'20px',color:'white',transition:'transform 0.3s ease',cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0',fontSize:'0.9rem',opacity:0.9},children:\"\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A \\u0627\\u0644\\u062A\\u0643\\u0627\\u0644\\u064A\\u0641\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'1.5rem',fontWeight:'bold',marginTop:'10px'},children:[totalCosts.toLocaleString(),\" \\u062F.\\u0639\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #2196F3 0%, #1976D2 100%)',borderRadius:'15px',padding:'20px',color:'white',transition:'transform 0.3s ease',cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0',fontSize:'0.9rem',opacity:0.9},children:\"\\u0647\\u0627\\u0645\\u0634 \\u0627\\u0644\\u0631\\u0628\\u062D\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'1.5rem',fontWeight:'bold',marginTop:'10px'},children:[profitMargin,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'linear-gradient(135deg, #FF9800 0%, #F57C00 100%)',borderRadius:'15px',padding:'20px',color:'white',transition:'transform 0.3s ease',cursor:'pointer'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0',fontSize:'0.9rem',opacity:0.9},children:\"\\u0645\\u062A\\u0648\\u0633\\u0637 \\u0642\\u064A\\u0645\\u0629 \\u0627\\u0644\\u0637\\u0644\\u0628\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'1.5rem',fontWeight:'bold',marginTop:'10px'},children:[averageOrderValue.toLocaleString(),\" \\u062F.\\u0639\"]})]})]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"analytics-container\",children:[renderAnalyticsStats(),\" \",!savedName?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"name-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:name,onChange:e=>setName(e.target.value),placeholder:\"\\u0623\\u062F\\u062E\\u0644 \\u0627\\u0633\\u0645\\u0643 \\u0647\\u0646\\u0627\",className:\"name-input arabic-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-btn\",children:\"\\u062A\\u0645\"})]}):showWelcome?/*#__PURE__*/_jsx(\"div\",{className:\"welcome-container\",children:getWelcomeMessage(savedName)}):isAuthorized(savedName)?/*#__PURE__*/_jsx(Dashboard,{}):/*#__PURE__*/_jsx(UserUnauthorizedScreen,{})]});};export default Analytics;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}