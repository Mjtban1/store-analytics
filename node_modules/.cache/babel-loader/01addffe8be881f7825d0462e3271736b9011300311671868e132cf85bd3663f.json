{"ast":null,"code":"// Import the functions you need from the SDKs you need\nimport{initializeApp}from\"firebase/app\";import{getFirestore}from\"firebase/firestore\";import{getMessaging,getToken}from\"firebase/messaging\";import{getAuth,signInAnonymously}from\"firebase/auth\";// Your web app's Firebase configuration\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\nconst firebaseConfig={apiKey:process.env.REACT_APP_FIREBASE_API_KEY,authDomain:process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,projectId:process.env.REACT_APP_FIREBASE_PROJECT_ID,storageBucket:process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,messagingSenderId:process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,appId:process.env.REACT_APP_FIREBASE_APP_ID};// Initialize Firebase\nconst app=initializeApp(firebaseConfig);export const auth=getAuth(app);export const db=getFirestore(app);export const messaging=getMessaging(app);export const initializeMessaging=async()=>{try{// First authenticate anonymously\nconst authResult=await signInAnonymously(auth);console.log('Anonymous auth successful');if(!messaging)return null;// Get auth token\nconst idToken=await authResult.user.getIdToken();const registration=await navigator.serviceWorker.getRegistration();if(!registration){throw new Error('No service worker registration found');}const token=await getToken(messaging,{vapidKey:process.env.REACT_APP_FIREBASE_VAPID_KEY,serviceWorkerRegistration:registration,authenticatedUserToken:idToken});if(!token)throw new Error('No token received');console.log('FCM Token obtained:',token);return token;}catch(error){console.error(\"Error in initializeMessaging:\",error);throw error;}};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}