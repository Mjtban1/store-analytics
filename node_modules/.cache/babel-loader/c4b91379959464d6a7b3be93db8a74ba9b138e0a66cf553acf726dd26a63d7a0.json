{"ast":null,"code":"import React from'react';import{Chart as ChartJS,CategoryScale,LinearScale,PointElement,LineElement,Title,Tooltip,Legend}from'chart.js';import{Line}from'react-chartjs-2';import{format}from'date-fns';import{ar}from'date-fns/locale';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";ChartJS.register(CategoryScale,LinearScale,PointElement,LineElement,Title,Tooltip,Legend);const RevenueChart=_ref=>{let{orders}=_ref;if(!orders||orders.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"no-data\",style:{fontFamily:'Tajawal',fontSize:'1.4rem',color:'#666',textAlign:'center',padding:'40px'},children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0628\\u064A\\u0627\\u0646\\u0627\\u062A \\u0644\\u0644\\u0639\\u0631\\u0636\"});}// تحسين تجميع البيانات حسب الساعة\nconst hourlyOrders=orders.reduce((acc,order)=>{const date=new Date(order.timestamp.seconds*1000);const hour=date.getHours();if(!acc[hour]){acc[hour]={totalRevenue:0,totalCost:0,profit:0,count:0,avgRevenue:0,avgProfit:0};}const revenue=Number(order.sellingPrice);const cost=Number(order.costPrice);const profit=revenue-cost;acc[hour].totalRevenue+=revenue;acc[hour].totalCost+=cost;acc[hour].profit+=profit;acc[hour].count+=1;acc[hour].avgRevenue=acc[hour].totalRevenue/acc[hour].count;acc[hour].avgProfit=acc[hour].profit/acc[hour].count;return acc;},{});const hours=Array.from({length:24},(_,i)=>i);const chartData={labels:hours.map(hour=>`${hour}:00`),datasets:[{label:'الإيرادات',data:hours.map(hour=>{var _hourlyOrders$hour;return((_hourlyOrders$hour=hourlyOrders[hour])===null||_hourlyOrders$hour===void 0?void 0:_hourlyOrders$hour.totalRevenue)||0;}),borderColor:'#4CAF50',backgroundColor:'rgba(76, 175, 80, 0.1)',fill:true,tension:0.4,borderWidth:3,pointRadius:6,pointHoverRadius:8,pointBackgroundColor:'#4CAF50',pointBorderColor:'#fff',pointBorderWidth:2,pointHoverBackgroundColor:'#fff',pointHoverBorderColor:'#4CAF50',order:1},{label:'التكاليف',data:hours.map(hour=>{var _hourlyOrders$hour2;return((_hourlyOrders$hour2=hourlyOrders[hour])===null||_hourlyOrders$hour2===void 0?void 0:_hourlyOrders$hour2.totalCost)||0;}),borderColor:'#f44336',backgroundColor:'rgba(244, 67, 54, 0.1)',fill:true,tension:0.4,borderWidth:3,pointRadius:6,pointHoverRadius:8,pointBackgroundColor:'#f44336',pointBorderColor:'#fff',pointBorderWidth:2,pointHoverBackgroundColor:'#fff',pointHoverBorderColor:'#f44336',order:2},{label:'صافي الربح',data:hours.map(hour=>{var _hourlyOrders$hour3;return((_hourlyOrders$hour3=hourlyOrders[hour])===null||_hourlyOrders$hour3===void 0?void 0:_hourlyOrders$hour3.profit)||0;}),borderColor:'#2196F3',backgroundColor:'rgba(33, 150, 243, 0.1)',fill:true,tension:0.4,borderWidth:3,pointRadius:6,pointHoverRadius:8,pointBackgroundColor:'#2196F3',pointBorderColor:'#fff',pointBorderWidth:2,pointHoverBackgroundColor:'#fff',pointHoverBorderColor:'#2196F3',order:3},{label:'عدد الطلبات',data:hours.map(hour=>{var _hourlyOrders$hour4;return((_hourlyOrders$hour4=hourlyOrders[hour])===null||_hourlyOrders$hour4===void 0?void 0:_hourlyOrders$hour4.count)||0;}),borderColor:'#FF9800',backgroundColor:'rgba(255, 152, 0, 0.1)',fill:true,tension:0.4,borderWidth:3,pointRadius:6,pointHoverRadius:8,pointBackgroundColor:'#FF9800',pointBorderColor:'#fff',pointBorderWidth:2,pointHoverBackgroundColor:'#fff',pointHoverBorderColor:'#FF9800',yAxisID:'count',order:4}]};const options={responsive:true,maintainAspectRatio:false,interaction:{mode:'index',intersect:false},plugins:{legend:{position:'top',rtl:true,labels:{font:{family:'Tajawal',size:14,weight:'bold'},padding:20,usePointStyle:true,pointStyle:'circle'}},tooltip:{backgroundColor:'rgba(255, 255, 255, 0.95)',titleColor:'#333',titleFont:{family:'Tajawal',size:16,weight:'bold'},bodyColor:'#666',bodyFont:{family:'Tajawal',size:14},borderColor:'#ddd',borderWidth:1,padding:15,boxPadding:10,displayColors:true,callbacks:{title:tooltipItems=>{const hour=tooltipItems[0].label;return`الساعة ${hour}`;},label:context=>{var _hourData$avgRevenue,_hourData$avgProfit;const hour=parseInt(context.label);const hourData=hourlyOrders[hour]||{};switch(context.dataset.label){case'الإيرادات':return[`الإيرادات: ${context.raw.toLocaleString()} د.ع`,`متوسط الإيراد للطلب: ${((_hourData$avgRevenue=hourData.avgRevenue)===null||_hourData$avgRevenue===void 0?void 0:_hourData$avgRevenue.toLocaleString())||0} د.ع`];case'التكاليف':return`التكاليف: ${context.raw.toLocaleString()} د.ع`;case'صافي الربح':return[`صافي الربح: ${context.raw.toLocaleString()} د.ع`,`متوسط الربح للطلب: ${((_hourData$avgProfit=hourData.avgProfit)===null||_hourData$avgProfit===void 0?void 0:_hourData$avgProfit.toLocaleString())||0} د.ع`];case'عدد الطلبات':return`عدد الطلبات: ${context.raw} طلب`;default:return'';}}}}},scales:{x:{grid:{display:true,color:'rgba(0, 0, 0, 0.05)'},ticks:{font:{family:'Tajawal',size:13,weight:'500'},color:'#666'}},y:{position:'left',min:20000,max:200000,grid:{color:'rgba(0, 0, 0, 0.05)'},ticks:{font:{family:'Tajawal',size:13,weight:'500'},color:'#666',callback:value=>`${(value/1000).toFixed(0)}k د.ع`}},count:{position:'right',grid:{display:false},ticks:{font:{family:'Tajawal',size:13,weight:'500'},color:'#FF9800',callback:value=>`${value} طلب`}}}};return/*#__PURE__*/_jsxs(\"div\",{className:\"chart-wrapper\",style:{padding:'30px',height:'500px',background:'white',borderRadius:'15px',boxShadow:'0 4px 20px rgba(0, 0, 0, 0.05)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px',textAlign:'center',fontFamily:'Tajawal'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'1.4rem',color:'#333',marginBottom:'10px'},children:\"\\u062A\\u062D\\u0644\\u064A\\u0644 \\u0627\\u0644\\u0625\\u064A\\u0631\\u0627\\u062F\\u0627\\u062A \\u0648\\u0627\\u0644\\u062A\\u0643\\u0627\\u0644\\u064A\\u0641 \\u062D\\u0633\\u0628 \\u0633\\u0627\\u0639\\u0627\\u062A \\u0627\\u0644\\u064A\\u0648\\u0645\"}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'1rem',color:'#666'},children:[\"\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A \\u0627\\u0644\\u0637\\u0644\\u0628\\u0627\\u062A: \",orders.length,\" \\u0637\\u0644\\u0628\"]})]}),/*#__PURE__*/_jsx(Line,{data:chartData,options:options})]});};export default RevenueChart;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}