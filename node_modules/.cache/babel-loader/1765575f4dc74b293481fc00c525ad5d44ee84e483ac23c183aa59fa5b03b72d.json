{"ast":null,"code":"import React,{useState,useEffect}from'react';import{db}from'../../firebase/config';import{collection,addDoc,getDocs,deleteDoc,doc,query,where,orderBy}from'firebase/firestore';import RevenueChart from'../Charts/RevenueChart';import OrderTypesChart from'../Charts/OrderTypesChart';import OrderDetails from'../Charts/OrderDetails';import'./Dashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Dashboard=_ref=>{let{orders:initialOrders}=_ref;const[activeSection,setActiveSection]=useState('orders');const[showCustomInput,setShowCustomInput]=useState(false);const[customProductName,setCustomProductName]=useState('');const[customProducts,setCustomProducts]=useState({games:[],subscriptions:[],services:[]});const[formData,setFormData]=useState({productName:'',costPrice:'',sellingPrice:'',description:'',serviceType:'games',// Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©\nsubType:''// Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„ÙØ±Ø¹ÙŠ\n});const[capitalHistory,setCapitalHistory]=useState([]);const[newCapital,setNewCapital]=useState({amount:'',note:'',date:new Date().toISOString().split('T')[0]});const[totalCapital,setTotalCapital]=useState(0);const[capitalFilter,setCapitalFilter]=useState({startDate:'',endDate:''});// Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯\nconst[deleteModal,setDeleteModal]=useState({isOpen:false,itemId:null});const[orders,setOrders]=useState(initialOrders||[]);const[analytics,setAnalytics]=useState({totalRevenue:0,totalCost:0,totalProfit:0,profitMargin:0,ordersByType:{},revenueByType:{}});const sections={orders:{title:'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª',icon:'ðŸ“¦'},capital:{title:'Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„',icon:'ðŸ’°'},analytics:{title:'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª',icon:'ðŸ“Š'},archive:{title:'Ø§Ù„Ø£Ø±Ø´ÙŠÙ',icon:'ðŸ“‚'}};const handleInputChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});};const validateForm=()=>{var _formData$productName;return((_formData$productName=formData.productName)===null||_formData$productName===void 0?void 0:_formData$productName.trim())&&formData.costPrice&&formData.sellingPrice&&formData.serviceType&&formData.subType;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm()){alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');return;}try{const orderData={...formData,timestamp:new Date(),// Store as Date object\nprofit:Number(formData.sellingPrice)-Number(formData.costPrice),profitMargin:(Number(formData.sellingPrice)-Number(formData.costPrice))/Number(formData.sellingPrice)*100};const docRef=await addDoc(collection(db,'orders'),orderData);// Update local state with the correct timestamp\nsetOrders(prev=>[...prev,{id:docRef.id,...orderData}]);updateAnalytics([...orders,orderData]);// Reset form\nsetFormData({productName:'',costPrice:'',sellingPrice:'',description:'',serviceType:'games',subType:''});alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');}catch(error){console.error(\"Error adding order:\",error);alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬');}};// Ø¥Ø¶Ø§ÙØ© useEffect Ù„Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒÙˆÙ†\nuseEffect(()=>{const fetchCustomProducts=async()=>{try{const customProductsRef=collection(db,'customProducts');const querySnapshot=await getDocs(customProductsRef);const products={games:[],subscriptions:[],services:[]};querySnapshot.forEach(doc=>{const product={id:doc.id,...doc.data()};products[product.category].push(product);});setCustomProducts(products);}catch(error){console.error(\"Error fetching custom products:\",error);}};fetchCustomProducts();},[]);useEffect(()=>{fetchCapitalHistory();},[]);const fetchCapitalHistory=async()=>{try{const capitalRef=collection(db,'capital');const q=query(capitalRef,orderBy('date','desc'));const querySnapshot=await getDocs(q);const history=[];let total=0;querySnapshot.forEach(doc=>{const data={id:doc.id,...doc.data()};history.push(data);total+=Number(data.amount);});setCapitalHistory(history);setTotalCapital(total);}catch(error){console.error(\"Error fetching capital history:\",error);}};const handleAddCapital=async e=>{e.preventDefault();if(!newCapital.amount||!newCapital.date)return;try{await addDoc(collection(db,'capital'),{amount:Number(newCapital.amount),note:newCapital.note,date:newCapital.date,timestamp:new Date()});setNewCapital({amount:'',note:'',date:new Date().toISOString().split('T')[0]});await fetchCapitalHistory();}catch(error){console.error(\"Error adding capital:\",error);}};// ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø§Ù„Ø© handleDeleteCapital\nconst handleDeleteCapital=async id=>{setDeleteModal({isOpen:true,itemId:id});};// Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© confirmDelete\nconst confirmDelete=async()=>{try{await deleteDoc(doc(db,'capital',deleteModal.itemId));await fetchCapitalHistory();setDeleteModal({isOpen:false,itemId:null});}catch(error){console.error(\"Error deleting capital:\",error);}};// Ø¥Ø¶Ø§ÙØ© Ù…ÙƒÙˆÙ† DeleteConfirmModal\nconst DeleteConfirmModal=()=>{if(!deleteModal.isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"delete-modal-overlay\",onClick:()=>setDeleteModal({isOpen:false,itemId:null}),children:/*#__PURE__*/_jsxs(\"div\",{className:\"delete-modal\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"span\",{className:\"delete-modal-emoji\",children:\"\\uD83D\\uDDD1\\uFE0F\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"delete-modal-title\",children:\"\\u062A\\u0623\\u0643\\u064A\\u062F \\u0627\\u0644\\u062D\\u0630\\u0641\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"delete-modal-message\",children:[\"\\u0647\\u0644 \\u0623\\u0646\\u062A \\u0645\\u062A\\u0623\\u0643\\u062F \\u0645\\u0646 \\u062D\\u0630\\u0641 \\u0647\\u0630\\u0627 \\u0627\\u0644\\u0645\\u0628\\u0644\\u063A\\u061F\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u0644\\u0627 \\u064A\\u0645\\u0643\\u0646 \\u0627\\u0644\\u062A\\u0631\\u0627\\u062C\\u0639 \\u0639\\u0646 \\u0647\\u0630\\u0627 \\u0627\\u0644\\u0625\\u062C\\u0631\\u0627\\u0621.\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"delete-modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"delete-modal-btn confirm\",onClick:confirmDelete,children:\"\\u062D\\u0630\\u0641\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-modal-btn cancel\",onClick:()=>setDeleteModal({isOpen:false,itemId:null}),children:\"\\u0625\\u0644\\u063A\\u0627\\u0621\"})]})]})});};const getFilteredCapital=()=>{if(!capitalFilter.startDate&&!capitalFilter.endDate){return capitalHistory;}return capitalHistory.filter(item=>{const itemDate=new Date(item.date);const start=capitalFilter.startDate?new Date(capitalFilter.startDate):null;const end=capitalFilter.endDate?new Date(capitalFilter.endDate):null;if(start&&end){return itemDate>=start&&itemDate<=end;}else if(start){return itemDate>=start;}else if(end){return itemDate<=end;}return true;});};const handleCustomProductAdd=async()=>{if(customProductName.trim()){try{// Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Firestore\nconst customProductsRef=collection(db,'customProducts');const newProduct={name:customProductName.trim(),category:formData.serviceType,createdAt:new Date()};const docRef=await addDoc(customProductsRef,newProduct);// ØªØ­Ø¯ÙŠØ« state Ø§Ù„Ù…Ø­Ù„ÙŠ\nsetCustomProducts(prev=>({...prev,[formData.serviceType]:[...prev[formData.serviceType],{id:docRef.id,...newProduct}]}));setCustomProductName('');setShowCustomInput(false);}catch(error){console.error(\"Error adding custom product:\",error);}}};const handleCustomProductDelete=async productId=>{try{// Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Firestore\nawait deleteDoc(doc(db,'customProducts',productId));// ØªØ­Ø¯ÙŠØ« state Ø§Ù„Ù…Ø­Ù„ÙŠ\nsetCustomProducts(prev=>({...prev,[formData.serviceType]:prev[formData.serviceType].filter(p=>p.id!==productId)}));// Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø­Ø°ÙˆÙ Ù‡Ùˆ Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø­Ø§Ù„ÙŠØ§Ù‹\nif(formData.subType===productId){setFormData({...formData,subType:'',productName:''});}}catch(error){console.error(\"Error deleting custom product:\",error);}};const handleSubTypeClick=function(subType){let customName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';// Ø¥Ø°Ø§ ØªÙ… Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± \"Ù…Ù†ØªØ¬ Ù…Ø®ØµØµ\"\nif(subType==='custom'&&!customName){setShowCustomInput(true);// Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø®ØµØµ\nsetFormData({...formData,subType:'',productName:''});return;}setShowCustomInput(false);if(customName){// Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬ Ù…Ø®ØµØµ Ù…ÙˆØ¬ÙˆØ¯\nsetFormData({...formData,subType:customName,productName:customName});}else{// Ù„Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©\nsetFormData({...formData,subType,productName:subType==='crew'?'ÙƒØ±Ùˆ':subType==='vbucks'?'ÙÙŠØ¨ÙˆÙƒØ³':subType==='netflix'?'Ù†ØªÙÙ„ÙƒØ³':subType==='shahid'?'Ø´Ø§Ù‡Ø¯':subType==='prime'?'Ø¨Ø±Ø§ÙŠÙ…':subType==='promotion'?'ØªØ±ÙˆÙŠØ¬':subType==='video'?'ÙÙŠØ¯ÙŠÙˆ Ø¥Ø¹Ù„Ø§Ù†ÙŠ':''});}};const getSubTypeButtons=()=>{switch(formData.serviceType){case'games':return/*#__PURE__*/_jsxs(\"div\",{className:\"sub-type-buttons\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn ${formData.subType==='crew'?'active':''}`,onClick:()=>handleSubTypeClick('crew'),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC65\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0643\\u0631\\u0648\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn ${formData.subType==='vbucks'?'active':''}`,onClick:()=>handleSubTypeClick('vbucks'),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC8E\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0641\\u064A\\u0628\\u0648\\u0643\\u0633\"})]}),customProducts.games.map(product=>/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn custom-product ${formData.subType===product.name?'active':''}`,onClick:()=>handleSubTypeClick('custom',product.name),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDFAE\"}),/*#__PURE__*/_jsx(\"span\",{children:product.name}),/*#__PURE__*/_jsx(\"span\",{className:\"delete-custom-product\",onClick:e=>{e.stopPropagation();handleCustomProductDelete(product.id);// Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø®ØµØµ Ù‡Ùˆ Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø­Ø§Ù„ÙŠØ§Ù‹ØŒ Ù‚Ù… Ø¨Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„\nif(formData.subType===product.name){setFormData({...formData,subType:'',productName:''});}},children:\"\\xD7\"})]},product.id)),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn ${formData.subType==='custom'?'active':''}`,onClick:()=>handleSubTypeClick('custom'),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0645\\u0646\\u062A\\u062C \\u0645\\u062E\\u0635\\u0635\"})]}),showCustomInput&&/*#__PURE__*/_jsxs(\"div\",{className:\"custom-product-input\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:customProductName,onChange:e=>setCustomProductName(e.target.value),placeholder:\"\\u0627\\u0633\\u0645 \\u0627\\u0644\\u0645\\u0646\\u062A\\u062C \\u0627\\u0644\\u0645\\u062E\\u0635\\u0635\",className:\"form-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleCustomProductAdd,className:\"add-custom-btn\",children:\"\\u0625\\u0636\\u0627\\u0641\\u0629\"})]})]});case'subscriptions':return/*#__PURE__*/_jsxs(\"div\",{className:\"sub-type-buttons\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn ${formData.subType==='netflix'?'active':''}`,onClick:()=>handleSubTypeClick('netflix'),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDFAC\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0646\\u062A\\u0641\\u0644\\u0643\\u0633\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn ${formData.subType==='shahid'?'active':''}`,onClick:()=>handleSubTypeClick('shahid'),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCFA\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0634\\u0627\\u0647\\u062F\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn ${formData.subType==='prime'?'active':''}`,onClick:()=>handleSubTypeClick('prime'),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDED2\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0628\\u0631\\u0627\\u064A\\u0645\"})]}),customProducts.subscriptions.map(product=>/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn custom-product ${formData.subType===product.name?'active':''}`,onClick:()=>handleSubTypeClick('custom',product.name),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDFAF\"}),/*#__PURE__*/_jsx(\"span\",{children:product.name}),/*#__PURE__*/_jsx(\"span\",{className:\"delete-custom-product\",onClick:e=>{e.stopPropagation();handleCustomProductDelete(product.id);if(formData.subType===product.name){setFormData({...formData,subType:'',productName:''});}},children:\"\\xD7\"})]},product.id)),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn ${formData.subType==='custom'?'active':''}`,onClick:()=>handleSubTypeClick('custom'),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0645\\u0646\\u062A\\u062C \\u0645\\u062E\\u0635\\u0635\"})]}),showCustomInput&&/*#__PURE__*/_jsxs(\"div\",{className:\"custom-product-input\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:customProductName,onChange:e=>setCustomProductName(e.target.value),placeholder:\"\\u0627\\u0633\\u0645 \\u0627\\u0644\\u0645\\u0646\\u062A\\u062C \\u0627\\u0644\\u0645\\u062E\\u0635\\u0635\",className:\"form-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleCustomProductAdd,className:\"add-custom-btn\",children:\"\\u0625\\u0636\\u0627\\u0641\\u0629\"})]})]});case'services':return/*#__PURE__*/_jsxs(\"div\",{className:\"sub-type-buttons\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn ${formData.subType==='promotion'?'active':''}`,onClick:()=>handleSubTypeClick('promotion'),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCE2\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u062A\\u0631\\u0648\\u064A\\u062C\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn ${formData.subType==='video'?'active':''}`,onClick:()=>handleSubTypeClick('video'),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDFA5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0641\\u064A\\u062F\\u064A\\u0648 \\u0625\\u0639\\u0644\\u0627\\u0646\\u064A\"})]}),customProducts.services.map(product=>/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn custom-product ${formData.subType===product.name?'active':''}`,onClick:()=>handleSubTypeClick('custom',product.name),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A1\"}),/*#__PURE__*/_jsx(\"span\",{children:product.name}),/*#__PURE__*/_jsx(\"span\",{className:\"delete-custom-product\",onClick:e=>{e.stopPropagation();handleCustomProductDelete(product.id);if(formData.subType===product.name){setFormData({...formData,subType:'',productName:''});}},children:\"\\xD7\"})]},product.id)),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`sub-type-btn ${formData.subType==='custom'?'active':''}`,onClick:()=>handleSubTypeClick('custom'),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0645\\u0646\\u062A\\u062C \\u0645\\u062E\\u0635\\u0635\"})]}),showCustomInput&&/*#__PURE__*/_jsxs(\"div\",{className:\"custom-product-input\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:customProductName,onChange:e=>setCustomProductName(e.target.value),placeholder:\"\\u0627\\u0633\\u0645 \\u0627\\u0644\\u0645\\u0646\\u062A\\u062C \\u0627\\u0644\\u0645\\u062E\\u0635\\u0635\",className:\"form-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleCustomProductAdd,className:\"add-custom-btn\",children:\"\\u0625\\u0636\\u0627\\u0641\\u0629\"})]})]});default:return null;}};// Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø©\nconst getMonthlyGrowth=history=>{if(history.length<2)return 0;const currentMonth=new Date().getMonth();const currentYear=new Date().getFullYear();const thisMonthTotal=history.filter(item=>{const date=new Date(item.date);return date.getMonth()===currentMonth&&date.getFullYear()===currentYear;}).reduce((sum,item)=>sum+Number(item.amount),0);const lastMonthTotal=history.filter(item=>{const date=new Date(item.date);return date.getMonth()===currentMonth-1&&date.getFullYear()===currentYear;}).reduce((sum,item)=>sum+Number(item.amount),0);if(lastMonthTotal===0)return 0;return((thisMonthTotal-lastMonthTotal)/lastMonthTotal*100).toFixed(1);};const getAverageAddition=history=>{if(history.length===0)return 0;const monthlyTotals={};history.forEach(item=>{const date=new Date(item.date);const monthKey=`${date.getFullYear()}-${date.getMonth()}`;monthlyTotals[monthKey]=(monthlyTotals[monthKey]||0)+Number(item.amount);});const totalMonths=Object.keys(monthlyTotals).length;const totalAmount=Object.values(monthlyTotals).reduce((sum,val)=>sum+val,0);return Math.round(totalAmount/totalMonths);};// ØªØ¹Ø¯ÙŠÙ„ renderCapitalSection\nconst renderCapitalSection=()=>{const filteredHistory=getFilteredCapital();const filteredTotal=filteredHistory.reduce((acc,curr)=>acc+Number(curr.amount),0);const growthRate=getMonthlyGrowth(capitalHistory);const avgAddition=getAverageAddition(capitalHistory);return/*#__PURE__*/_jsxs(\"div\",{className:\"capital-section\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"capital-header\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"section-icon\",children:\"\\uD83D\\uDCB0\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0625\\u062F\\u0627\\u0631\\u0629 \\u0648\\u062A\\u062D\\u0644\\u064A\\u0644 \\u0631\\u0623\\u0633 \\u0627\\u0644\\u0645\\u0627\\u0644\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"capital-grid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"capital-card primary\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"capital-card-content\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-wallet\"}),\"\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A \\u0631\\u0623\\u0633 \\u0627\\u0644\\u0645\\u0627\\u0644\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"amount\",children:[totalCapital.toLocaleString(),/*#__PURE__*/_jsx(\"span\",{children:\"\\u062F.\\u0639\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-footer\",children:\"\\u0645\\u062C\\u0645\\u0648\\u0639 \\u0643\\u0644 \\u0627\\u0644\\u0625\\u0636\\u0627\\u0641\\u0627\\u062A\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:`capital-card ${growthRate>=0?'secondary':'danger'}`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"capital-card-content\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-chart-line\"}),\"\\u0627\\u0644\\u0646\\u0645\\u0648 \\u0627\\u0644\\u0634\\u0647\\u0631\\u064A\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"amount\",children:[growthRate,/*#__PURE__*/_jsx(\"span\",{children:\"%\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-footer\",children:\"\\u0645\\u0642\\u0627\\u0631\\u0646\\u0629 \\u0628\\u0627\\u0644\\u0634\\u0647\\u0631 \\u0627\\u0644\\u0633\\u0627\\u0628\\u0642\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"capital-card warning\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"capital-card-content\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-coins\"}),\"\\u0645\\u0639\\u062F\\u0644 \\u0627\\u0644\\u0625\\u0636\\u0627\\u0641\\u0627\\u062A\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"amount\",children:[avgAddition.toLocaleString(),/*#__PURE__*/_jsx(\"span\",{children:\"\\u062F.\\u0639 / \\u0634\\u0647\\u0631\\u064A\\u0627\\u064B\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-footer\",children:\"\\u0645\\u062A\\u0648\\u0633\\u0637 \\u0627\\u0644\\u0625\\u0636\\u0627\\u0641\\u0627\\u062A \\u0627\\u0644\\u0634\\u0647\\u0631\\u064A\\u0629\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"capital-form-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0625\\u0636\\u0627\\u0641\\u0629 \\u0631\\u0623\\u0633 \\u0645\\u0627\\u0644 \\u062C\\u062F\\u064A\\u062F\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"capital-form\",onSubmit:handleAddCapital,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"capital-input-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0627\\u0644\\u0645\\u0628\\u0644\\u063A \\u0627\\u0644\\u0645\\u0636\\u0627\\u0641\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"capital-input\",value:newCapital.amount,onChange:e=>setNewCapital({...newCapital,amount:e.target.value}),placeholder:\"\\u0623\\u062F\\u062E\\u0644 \\u0627\\u0644\\u0645\\u0628\\u0644\\u063A\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"capital-input-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0627\\u0644\\u062A\\u0627\\u0631\\u064A\\u062E\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"capital-input\",value:newCapital.date,onChange:e=>setNewCapital({...newCapital,date:e.target.value}),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"capital-input-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0645\\u0644\\u0627\\u062D\\u0638\\u0627\\u062A\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"capital-input\",value:newCapital.note,onChange:e=>setNewCapital({...newCapital,note:e.target.value}),placeholder:\"\\u0625\\u0636\\u0627\\u0641\\u0629 \\u0645\\u0644\\u0627\\u062D\\u0638\\u0629 (\\u0627\\u062E\\u062A\\u064A\\u0627\\u0631\\u064A)\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"capital-submit-btn\",children:\"\\u0625\\u0636\\u0627\\u0641\\u0629 \\u0631\\u0623\\u0633 \\u0645\\u0627\\u0644\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"capital-history-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0633\\u062C\\u0644 \\u0631\\u0623\\u0633 \\u0627\\u0644\\u0645\\u0627\\u0644\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"history-filters\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"date-filter\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0645\\u0646 \\u062A\\u0627\\u0631\\u064A\\u062E\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"capital-input\",value:capitalFilter.startDate,onChange:e=>setCapitalFilter({...capitalFilter,startDate:e.target.value})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"date-filter\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0625\\u0644\\u0649 \\u062A\\u0627\\u0631\\u064A\\u062E\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"capital-input\",value:capitalFilter.endDate,onChange:e=>setCapitalFilter({...capitalFilter,endDate:e.target.value})})]}),(capitalFilter.startDate||capitalFilter.endDate)&&/*#__PURE__*/_jsxs(\"div\",{className:\"filtered-total\",children:[\"\\u0627\\u0644\\u0645\\u062C\\u0645\\u0648\\u0639 \\u0627\\u0644\\u0645\\u0635\\u0641\\u0649: \",filteredTotal.toLocaleString(),\" \\u062F.\\u0639\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"history-list\",children:filteredHistory.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"history-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"history-details\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"amount-cell\",children:[Number(item.amount).toLocaleString(),\" \\u062F.\\u0639\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"date-cell\",children:new Date(item.date).toLocaleDateString('ar-IQ')}),item.note&&/*#__PURE__*/_jsx(\"span\",{className:\"note-cell\",children:item.note})]}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-row-btn\",onClick:()=>handleDeleteCapital(item.id),children:\"\\xD7\"})]},item.id))})]})]});};// Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© updateAnalytics\nconst updateAnalytics=ordersData=>{const analytics={totalRevenue:0,totalCost:0,totalProfit:0,profitMargin:0,ordersByType:{},revenueByType:{}};ordersData.forEach(order=>{analytics.totalRevenue+=Number(order.sellingPrice);analytics.totalCost+=Number(order.costPrice);// Update counts by type\nanalytics.ordersByType[order.serviceType]=(analytics.ordersByType[order.serviceType]||0)+1;analytics.revenueByType[order.serviceType]=(analytics.revenueByType[order.serviceType]||0)+Number(order.sellingPrice);});analytics.totalProfit=analytics.totalRevenue-analytics.totalCost;analytics.profitMargin=analytics.totalProfit/analytics.totalRevenue*100;setAnalytics(analytics);};// Ø¥Ø¶Ø§ÙØ© useEffect Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª\nuseEffect(()=>{const fetchOrders=async()=>{try{if(!initialOrders){const querySnapshot=await getDocs(collection(db,'orders'));const ordersData=querySnapshot.docs.map(doc=>{var _doc$data$timestamp,_doc$data$timestamp$t;return{id:doc.id,...doc.data(),timestamp:((_doc$data$timestamp=doc.data().timestamp)===null||_doc$data$timestamp===void 0?void 0:(_doc$data$timestamp$t=_doc$data$timestamp.toDate)===null||_doc$data$timestamp$t===void 0?void 0:_doc$data$timestamp$t.call(_doc$data$timestamp))||new Date()};});setOrders(ordersData);updateAnalytics(ordersData);}else{updateAnalytics(initialOrders);}}catch(error){console.error(\"Error fetching orders:\",error);}};fetchOrders();},[initialOrders]);// Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© renderAnalyticsStats\nconst renderAnalyticsStats=()=>{const totalRevenue=orders.reduce((sum,order)=>sum+Number(order.sellingPrice),0);const totalCosts=orders.reduce((sum,order)=>sum+Number(order.costPrice),0);const profit=totalRevenue-totalCosts;const profitMargin=totalRevenue>0?(profit/totalRevenue*100).toFixed(1):0;const averageOrderValue=orders.length>0?(totalRevenue/orders.length).toFixed(0):0;const statCards=[{title:'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª',value:`${totalRevenue.toLocaleString()} Ø¯.Ø¹`,icon:'ðŸ’°',color:'#4CAF50',gradient:'linear-gradient(135deg, #4CAF50, #45a049)'},{title:'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ',value:`${totalCosts.toLocaleString()} Ø¯.Ø¹`,icon:'ðŸ’³',color:'#f44336',gradient:'linear-gradient(135deg, #f44336, #e53935)'},{title:'ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­',value:`${profit.toLocaleString()} Ø¯.Ø¹`,icon:'ðŸ“ˆ',color:'#2196F3',gradient:'linear-gradient(135deg, #2196F3, #1976D2)'},{title:'Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­',value:`${profitMargin}%`,icon:'ðŸ“Š',color:'#FF9800',gradient:'linear-gradient(135deg, #FF9800, #F57C00)'}];return/*#__PURE__*/_jsx(\"div\",{className:\"analytics-stats\",style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(240px, 1fr))',gap:'20px',margin:'20px 0',padding:'0 10px'},children:statCards.map((card,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{background:card.gradient,borderRadius:'15px',padding:'20px',color:'white',display:'flex',flexDirection:'column',gap:'10px',boxShadow:'0 4px 15px rgba(0,0,0,0.1)',transition:'transform 0.3s ease',cursor:'pointer',minHeight:'150px',position:'relative',overflow:'hidden'},children:[/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'10px',left:'10px',fontSize:'2rem',opacity:'0.2'},children:card.icon}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0',fontSize:'1rem',opacity:'0.9'},children:card.title}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'1.8rem',fontWeight:'bold',marginTop:'auto'},children:card.value})]},index))});};// ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© renderAnalyticsSection Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©\nconst renderAnalyticsSection=()=>{if(activeSection!=='analytics')return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"analytics-section\",children:[renderAnalyticsStats(),/*#__PURE__*/_jsxs(\"div\",{className:\"charts-container\",children:[/*#__PURE__*/_jsx(RevenueChart,{orders:orders}),/*#__PURE__*/_jsx(OrderTypesChart,{orders:orders})]}),/*#__PURE__*/_jsx(OrderDetails,{orders:orders})]});};const renderContent=()=>{switch(activeSection){case'orders':return/*#__PURE__*/_jsxs(\"div\",{className:\"orders-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"section-icon\",children:\"\\uD83D\\uDCE6\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\u062A\\u0633\\u062C\\u064A\\u0644 \\u0627\\u0644\\u0645\\u0646\\u062A\\u062C\\u0627\\u062A \\u0648\\u0627\\u0644\\u0637\\u0644\\u0628\\u0627\\u062A\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"order-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"service-types\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`service-btn ${formData.serviceType==='games'?'active':''}`,onClick:()=>setFormData({...formData,serviceType:'games'}),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDFAE\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0623\\u0644\\u0639\\u0627\\u0628\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`service-btn ${formData.serviceType==='subscriptions'?'active':''}`,onClick:()=>setFormData({...formData,serviceType:'subscriptions'}),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDFAF\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0627\\u0634\\u062A\\u0631\\u0627\\u0643\\u0627\\u062A\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:`service-btn ${formData.serviceType==='services'?'active':''}`,onClick:()=>setFormData({...formData,serviceType:'services'}),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u062E\\u062F\\u0645\\u0627\\u062A\"})]})]}),getSubTypeButtons(),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0627\\u0633\\u0645 \\u0627\\u0644\\u0645\\u0646\\u062A\\u062C\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"productName\",className:\"form-input\",value:formData.productName,onChange:handleInputChange,placeholder:\"\\u0623\\u062F\\u062E\\u0644 \\u0627\\u0633\\u0645 \\u0627\\u0644\\u0645\\u0646\\u062A\\u062C\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0633\\u0639\\u0631 \\u0627\\u0644\\u062A\\u0643\\u0644\\u0641\\u0629\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"costPrice\",className:\"form-input\",value:formData.costPrice,onChange:handleInputChange,placeholder:\"\\u0633\\u0639\\u0631 \\u0627\\u0644\\u062A\\u0643\\u0644\\u0641\\u0629\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0633\\u0639\\u0631 \\u0627\\u0644\\u0628\\u064A\\u0639\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"sellingPrice\",className:\"form-input\",value:formData.sellingPrice,onChange:handleInputChange,placeholder:\"\\u0633\\u0639\\u0631 \\u0627\\u0644\\u0628\\u064A\\u0639\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group description-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0648\\u0635\\u0641 \\u0627\\u0644\\u0645\\u0646\\u062A\\u062C\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"description\",className:\"form-input\",value:formData.description,onChange:handleInputChange,placeholder:\"\\u0648\\u0635\\u0641 \\u062A\\u0641\\u0635\\u064A\\u0644\\u064A \\u0644\\u0644\\u0645\\u0646\\u062A\\u062C\",rows:\"4\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-btn\",children:\"\\u062A\\u0633\\u062C\\u064A\\u0644 \\u0627\\u0644\\u0645\\u0646\\u062A\\u062C\"})]})]});case'capital':return renderCapitalSection();case'analytics':return renderAnalyticsSection();case'archive':return/*#__PURE__*/_jsxs(\"div\",{className:\"archive-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0623\\u0631\\u0634\\u064A\\u0641 \\u0627\\u0644\\u0637\\u0644\\u0628\\u0627\\u062A\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"archive-filters\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\"}),/*#__PURE__*/_jsxs(\"select\",{children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"\\u0643\\u0644 \\u0627\\u0644\\u0637\\u0644\\u0628\\u0627\\u062A\"}),/*#__PURE__*/_jsx(\"option\",{value:\"completed\",children:\"\\u0627\\u0644\\u0645\\u0643\\u062A\\u0645\\u0644\\u0629\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cancelled\",children:\"\\u0627\\u0644\\u0645\\u0644\\u063A\\u064A\\u0629\"})]})]})]});default:return/*#__PURE__*/_jsx(\"div\",{children:\"\\u0627\\u062E\\u062A\\u0631 \\u0642\\u0633\\u0645\\u0627\\u064B\"});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsx(\"nav\",{className:\"dashboard-nav\",children:Object.entries(sections).map(_ref2=>{let[key,{title,icon}]=_ref2;return/*#__PURE__*/_jsxs(\"button\",{className:`nav-btn ${activeSection===key?'active':''}`,onClick:()=>setActiveSection(key),children:[/*#__PURE__*/_jsx(\"span\",{children:icon}),/*#__PURE__*/_jsx(\"span\",{children:title})]},key);})}),/*#__PURE__*/_jsx(\"main\",{className:\"dashboard-content\",children:renderContent()})]});};export default Dashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}