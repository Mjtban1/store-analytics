{"ast":null,"code":"import React,{useMemo}from'react';import{Chart as ChartJS,ArcElement,Tooltip,Legend}from'chart.js';import{Doughnut}from'react-chartjs-2';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";ChartJS.register(ArcElement,Tooltip,Legend);const OrderTypesChart=_ref=>{let{orders}=_ref;const processedData=useMemo(()=>{if(!(orders!==null&&orders!==void 0&&orders.length))return null;try{const summary={games:{count:0,revenue:0,label:'ألعاب',color:'#4CAF50'},subscriptions:{count:0,revenue:0,label:'اشتراكات',color:'#2196F3'},services:{count:0,revenue:0,label:'خدمات',color:'#FF9800'}};orders.forEach(order=>{try{const type=order.serviceType;if(summary[type]){summary[type].count++;const revenue=Number(order.sellingPrice)||0;if(!isNaN(revenue)){summary[type].revenue+=revenue;}}}catch(err){console.error(\"Error processing individual order:\",err);}});return summary;}catch(err){console.error(\"Error processing orders data:\",err);return null;}},[orders]);if(!processedData){return/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'20px',color:'#666',fontFamily:'Tajawal'},children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0628\\u064A\\u0627\\u0646\\u0627\\u062A \\u0644\\u0644\\u0639\\u0631\\u0636\"});}const chartData={labels:Object.values(processedData).map(item=>item.label),datasets:[{data:Object.values(processedData).map(item=>item.count),backgroundColor:Object.values(processedData).map(item=>item.color),borderWidth:0,borderRadius:5,spacing:2,hoverOffset:15}]};const options={responsive:true,maintainAspectRatio:true,cutout:'75%',layout:{padding:0},plugins:{legend:{display:false// إخفاء الليجند الافتراضي\n},tooltip:{enabled:true,backgroundColor:'rgba(255, 255, 255, 0.95)',titleColor:'#333',bodyColor:'#666',borderColor:'#ddd',borderWidth:1,padding:12,rtl:true,titleFont:{family:'Tajawal',size:14,weight:'bold'},bodyFont:{family:'Tajawal',size:13},callbacks:{label:context=>{const data=Object.values(processedData)[context.dataIndex];const percentage=(data.count/orders.length*100).toFixed(1);return[`${data.label}: ${data.count} طلب`,`الإيرادات: ${data.revenue.toLocaleString()} د.ع`,`النسبة: ${percentage}%`];}}}}};// حساب الإجماليات والنسب\nconst totalOrders=orders.length;const totalRevenue=Object.values(processedData).reduce((sum,item)=>sum+item.revenue,0);// حساب هامش الربح الإجمالي\nconst totalCost=orders.reduce((sum,order)=>sum+Number(order.costPrice),0);const profitMargin=((totalRevenue-totalCost)/totalRevenue*100).toFixed(1);return/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fff',borderRadius:'15px',padding:'20px',boxShadow:'0 2px 10px rgba(0,0,0,0.05)',display:'flex',flexDirection:'column',alignItems:'center',minHeight:'500px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'1.1rem',color:'#666',marginBottom:'20px',fontFamily:'Tajawal',fontWeight:'bold',textAlign:'center'},children:\"\\u062A\\u0648\\u0632\\u064A\\u0639 \\u0627\\u0644\\u0637\\u0644\\u0628\\u0627\\u062A \\u062D\\u0633\\u0628 \\u0627\\u0644\\u0646\\u0648\\u0639\"}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative',width:'100%',maxWidth:'300px',// تصغير حجم الدائرة\nmargin:'0 auto'},children:[/*#__PURE__*/_jsx(Doughnut,{data:chartData,options:options}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)',textAlign:'center',fontFamily:'Tajawal',width:'100%',maxWidth:'150px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'2rem',fontWeight:'800',color:'#333',marginBottom:'5px'},children:totalOrders}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.9rem',color:'#666',marginBottom:'10px'},children:\"\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A \\u0627\\u0644\\u0637\\u0644\\u0628\\u0627\\u062A\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'1.1rem',color:'#4CAF50',fontWeight:'bold'},children:[totalRevenue.toLocaleString(),\" \\u062F.\\u0639\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',gap:'20px',marginTop:'30px',flexWrap:'wrap'},children:Object.values(processedData).map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{width:'12px',height:'12px',borderRadius:'50%',backgroundColor:item.color}}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'0.9rem',color:'#666',fontFamily:'Tajawal'},children:item.label})]},index))}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',gap:'30px',marginTop:'30px',flexWrap:'wrap',padding:'15px',background:'#f8f9ff',borderRadius:'10px',width:'100%'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',fontFamily:'Tajawal'},children:[/*#__PURE__*/_jsx(\"div\",{style:{color:'#666',fontSize:'0.9rem'},children:\"\\u0647\\u0627\\u0645\\u0634 \\u0627\\u0644\\u0631\\u0628\\u062D\"}),/*#__PURE__*/_jsxs(\"div\",{style:{color:profitMargin>0?'#4CAF50':'#f44336',fontSize:'1.1rem',fontWeight:'bold'},children:[profitMargin,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',fontFamily:'Tajawal'},children:[/*#__PURE__*/_jsx(\"div\",{style:{color:'#666',fontSize:'0.9rem'},children:\"\\u0645\\u062A\\u0648\\u0633\\u0637 \\u0642\\u064A\\u0645\\u0629 \\u0627\\u0644\\u0637\\u0644\\u0628\"}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#2196F3',fontSize:'1.1rem',fontWeight:'bold'},children:[(totalRevenue/totalOrders).toFixed(0).toLocaleString(),\" \\u062F.\\u0639\"]})]})]})]});};export default OrderTypesChart;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}