{"ast":null,"code":"import React,{useState,useEffect}from'react';import{db}from'../../firebase/config';import{collection,addDoc,getDocs,query,where,deleteDoc,doc}from'firebase/firestore';import{getDeviceId}from'../../utils/deviceId';import Dashboard from'../Dashboard/Dashboard';import RevenueChart from'../Charts/RevenueChart';import OrderTypesChart from'../Charts/OrderTypesChart';import OrderDetails from'../Charts/OrderDetails';import'./Analytics.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Analytics=()=>{const[name,setName]=useState('');const[savedName,setSavedName]=useState('');const[docId,setDocId]=useState(null);const deviceId=getDeviceId();const[showWelcome,setShowWelcome]=useState(true);const[orders,setOrders]=useState([]);const authorizedUsers=[{names:['Ø´Ù…Ø³','Ø´Ù…ÙˆØ³','shams','shmoos'],type:'shams'},{names:['Ø¨Ù†ÙŠÙ†','Ø¨Ù†ÙˆÙ†Ù‡','baneen'],type:'baneen'},{names:['Ø¹Ù„ÙŠ','Ø¹Ù„Ù‰','ali'],type:'ali'},{names:['Ù…Ø¬ØªØ¨Ù‰','Ù…Ø¬ØªØ¨Ø§','mojtaba'],type:'mojtaba'}];const isAuthorized=name=>{const lowerName=name.toLowerCase().trim();return authorizedUsers.some(user=>user.names.includes(lowerName));};const getUserType=name=>{var _authorizedUsers$find;const lowerName=name.toLowerCase().trim();return((_authorizedUsers$find=authorizedUsers.find(user=>user.names.includes(lowerName)))===null||_authorizedUsers$find===void 0?void 0:_authorizedUsers$find.type)||'unauthorized';};useEffect(()=>{const fetchName=async()=>{const q=query(collection(db,'users'),where('deviceId','==',deviceId));const querySnapshot=await getDocs(q);querySnapshot.forEach(doc=>{setSavedName(doc.data().name);setDocId(doc.id);});};fetchName();},[deviceId]);useEffect(()=>{if(savedName){const timer=setTimeout(()=>{setShowWelcome(false);},2000);return()=>clearTimeout(timer);}},[savedName]);useEffect(()=>{const fetchOrders=async()=>{try{const querySnapshot=await getDocs(collection(db,'orders'));const ordersData=querySnapshot.docs.map(doc=>({id:doc.id,...doc.data()}));setOrders(ordersData);console.log(\"Fetched orders:\",ordersData);}catch(error){console.error(\"Error fetching orders:\",error);}};fetchOrders();},[]);const getWelcomeMessage=name=>{if(!isAuthorized(name)){return/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special unauthorized-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u26D4 \\u0639\\u0630\\u0631\\u0627\\u064B! \\u0623\\u0646\\u062A \\u063A\\u064A\\u0631 \\u0645\\u0635\\u0631\\u062D \\u0644\\u0643 \\u0628\\u0627\\u0644\\u062F\\u062E\\u0648\\u0644 \\u26D4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDEAB\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u26D4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDEA7\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"unauthorized-message\",children:\"\\u0647\\u0630\\u0627 \\u0627\\u0644\\u062A\\u0637\\u0628\\u064A\\u0642 \\u0645\\u062E\\u0635\\u0635 \\u0641\\u0642\\u0637 \\u0644\\u0644\\u0645\\u0633\\u062A\\u062E\\u062F\\u0645\\u064A\\u0646 \\u0627\\u0644\\u0645\\u0635\\u0631\\u062D \\u0644\\u0647\\u0645\"})]});}const userType=getUserType(name);switch(userType){case'shams':return/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special shams-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u2728 \\u0634\\u0645\\u0648\\u0633\\u0633\\u0633 \\u0627\\u0644\\u063A\\u0627\\u0644\\u064A \\u0627\\u0647\\u0644\\u0627 \\u2728\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF1F\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u2B50\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCAB\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF1E\"})]})]});case'baneen':return/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special baneen-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDC9D \\u0647\\u0644\\u0627\\u0648\\u0648\\u0648\\u0648 \\u0628\\u0646\\u0648\\u0646\\u0647 \\uD83D\\uDC9D\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF80\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC96\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83E\\uDD8B\"})]})]});case'ali':return/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special ali-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83C\\uDF1F \\u0645\\u0631\\u062D\\u0628\\u0627\\u064B \\u0639\\u0644\\u0627\\u0648\\u064A\\u064A\\u064A\\u064A \\uD83C\\uDF1F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCAA\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDC51\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF89\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A1\"})]})]});case'mojtaba':return/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special mojtaba-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83C\\uDF19 \\u0623\\u0647\\u0644\\u0627\\u064B \\u0645\\u062C\\u062A\\u0628\\u0649 \\uD83C\\uDF19\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF19\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83C\\uDF1F\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCAB\"})]})]});default:return null;}};const handleSubmit=async e=>{e.preventDefault();if(!isAuthorized(name)){setSavedName(name);// Still set the name to show unauthorized message\nreturn;}try{const docRef=await addDoc(collection(db,'users'),{name:name,deviceId:deviceId,timestamp:new Date()});setSavedName(name);setDocId(docRef.id);setName('');}catch(error){console.error(\"Error adding name: \",error);}};const handleRemove=async()=>{try{if(docId){await deleteDoc(doc(db,'users',docId));setSavedName('');setDocId(null);}}catch(error){console.error(\"Error removing name: \",error);}};const UserUnauthorizedScreen=()=>/*#__PURE__*/_jsx(\"div\",{className:\"unauthorized-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-special unauthorized-animation\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u26D4 \\u0639\\u0630\\u0631\\u0627\\u064B! \\u0623\\u0646\\u062A \\u063A\\u064A\\u0631 \\u0645\\u0635\\u0631\\u062D \\u0644\\u0643 \\u0628\\u0627\\u0644\\u062F\\u062E\\u0648\\u0644 \\u26D4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"floating-emojis\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDEAB\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u26D4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDEA7\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u26A0\\uFE0F\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"unauthorized-message\",children:\"\\u0647\\u0630\\u0627 \\u0627\\u0644\\u062A\\u0637\\u0628\\u064A\\u0642 \\u0645\\u062E\\u0635\\u0635 \\u0641\\u0642\\u0637 \\u0644\\u0644\\u0645\\u0633\\u062A\\u062E\\u062F\\u0645\\u064A\\u0646 \\u0627\\u0644\\u0645\\u0635\\u0631\\u062D \\u0644\\u0647\\u0645\"}),/*#__PURE__*/_jsx(\"button\",{className:\"reset-btn\",onClick:handleRemove,children:\"\\u0627\\u0644\\u0639\\u0648\\u062F\\u0629 \\u0644\\u0644\\u0635\\u0641\\u062D\\u0629 \\u0627\\u0644\\u0631\\u0626\\u064A\\u0633\\u064A\\u0629\"})]})});const renderAnalyticsStats=()=>{const totalRevenue=(orders===null||orders===void 0?void 0:orders.reduce((sum,order)=>sum+Number(order.sellingPrice),0))||0;const totalCosts=(orders===null||orders===void 0?void 0:orders.reduce((sum,order)=>sum+Number(order.costPrice),0))||0;const profit=totalRevenue-totalCosts;const profitMargin=totalRevenue>0?(profit/totalRevenue*100).toFixed(1):0;const averageOrderValue=(orders===null||orders===void 0?void 0:orders.length)>0?(totalRevenue/orders.length).toFixed(0):0;const statCards=[{title:'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª',value:`${totalRevenue.toLocaleString()} Ø¯.Ø¹`,icon:'ðŸŒŸ',mainEmoji:'ðŸ’°',gradient:'linear-gradient(135deg, #28c76f20, #28c76f40)',borderGradient:'linear-gradient(135deg, #28c76f, #1e8c4f)',particles:['ðŸ’µ','ðŸ’¸','ðŸ’Ž'],trend:'+12.5%',trendUp:true,description:'Ù…Ø¬Ù…ÙˆØ¹ ÙƒÙ„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',details:['Ø§Ù„ØªØ­ØµÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠ','Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹'],detailsIcons:['ðŸ“…','ðŸ“ˆ']},{title:'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ',value:`${totalCosts.toLocaleString()} Ø¯.Ø¹`,icon:'âš–ï¸',mainEmoji:'ðŸ’³',gradient:'linear-gradient(135deg, #e83e8c20, #e83e8c40)',borderGradient:'linear-gradient(135deg, #e83e8c, #c31d6a)',particles:['ðŸ’¹','ðŸ“Š','ðŸ”„'],trend:'-8.3%',trendUp:false,description:'Ù…Ø¬Ù…ÙˆØ¹ ÙƒÙ„ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª',details:['Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø«Ø§Ø¨ØªØ©','Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ù…ØªØºÙŠØ±Ø©'],detailsIcons:['ðŸ“Œ','ðŸ”„']},{title:'ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­',value:`${profit.toLocaleString()} Ø¯.Ø¹`,icon:'ðŸ“ˆ',mainEmoji:'âœ¨',gradient:'linear-gradient(135deg, #2196F320, #2196F340)',borderGradient:'linear-gradient(135deg, #2196F3, #0d47a1)',particles:['ðŸ’«','â­','ðŸŒŸ'],trend:'+15.2%',trendUp:true,description:'Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ØµØ§ÙÙŠØ©',details:['Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠ','Ø§Ù„Ù†Ù…Ùˆ Ø§Ù„Ø³Ù†ÙˆÙŠ'],detailsIcons:['ðŸ“Š','ðŸ“ˆ']},{title:'Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­',value:`${profitMargin}%`,icon:'ðŸ“Š',mainEmoji:'ðŸŽ¯',gradient:'linear-gradient(135deg, #FF980020, #FF980040)',borderGradient:'linear-gradient(135deg, #FF9800, #f57c00)',particles:['ðŸ’¡','ðŸ“ˆ','ðŸŽ¯'],trend:'+5.7%',trendUp:true,description:'Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ Ù…Ù† Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',details:['Ù…ØªÙˆØ³Ø· Ø§Ù„Ù‡Ø§Ù…Ø´','Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø´Ù‡Ø±ÙŠ'],detailsIcons:['ðŸ“Š','ðŸŽ¯']}];return/*#__PURE__*/_jsx(\"div\",{className:\"analytics-stats\",children:statCards.map((card,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",style:{background:card.gradient,border:'2px solid transparent',borderImage:card.borderGradient,borderImageSlice:1,borderRadius:'20px',padding:'25px',position:'relative',overflow:'hidden',transition:'all 0.3s ease'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-pattern\"}),/*#__PURE__*/_jsx(\"div\",{className:\"main-emoji-container\",children:/*#__PURE__*/_jsx(\"span\",{className:\"main-emoji\",children:card.mainEmoji})}),card.particles.map((particle,i)=>/*#__PURE__*/_jsx(\"span\",{className:`particle particle-${i}`,style:{position:'absolute',fontSize:'20px',opacity:0.5,animation:`float ${3+i}s ease-in-out infinite`},children:particle},i)),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:card.title}),/*#__PURE__*/_jsx(\"span\",{className:\"card-icon\",children:card.icon})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-value\",children:card.value}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-trend\",children:[/*#__PURE__*/_jsx(\"span\",{className:`trend-arrow ${card.trendUp?'up':'down'}`,children:card.trendUp?'â†—':'â†˜'}),/*#__PURE__*/_jsx(\"span\",{className:\"trend-value\",children:card.trend})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-details\",children:card.details.map((detail,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-icon\",children:card.detailsIcons[i]}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-text\",children:detail})]},i))})]})]},index))});};return/*#__PURE__*/_jsx(\"div\",{className:\"analytics-container\",children:!savedName?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"name-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:name,onChange:e=>setName(e.target.value),placeholder:\"\\u0623\\u062F\\u062E\\u0644 \\u0627\\u0633\\u0645\\u0643 \\u0647\\u0646\\u0627\",className:\"name-input arabic-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-btn\",children:\"\\u062A\\u0645\"})]}):showWelcome?/*#__PURE__*/_jsx(\"div\",{className:\"welcome-container\",children:getWelcomeMessage(savedName)}):isAuthorized(savedName)?/*#__PURE__*/_jsx(Dashboard,{orders:orders}):/*#__PURE__*/_jsx(UserUnauthorizedScreen,{})});};export default Analytics;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}